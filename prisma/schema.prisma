generator client {
  provider        = "prisma-client-js"
  previewFeatures = ["relationJoins"]
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Accounts {
  id               String   @id
  name             String?
  balance          Float
  iban             String?
  institution_name String?
  institution_logo String?
  last_synced      DateTime

  users        Users[]
  Transactions Transactions[]
}

// model UserAccounts {
//   user_id    Int
//   account_id String
//   user       Users    @relation(fields: [user_id], references: [id])
//   account    Accounts @relation(fields: [account_id], references: [id])

//   @@id([user_id, account_id])
// }

model Transactions {
  weight         Int      @id @default(autoincrement())
  transaction_id String?  @unique
  account_id     String
  amount         Float
  total_amount   Float
  title          String
  category       String
  date           DateTime
  account        Accounts @relation(fields: [account_id], references: [id], onDelete: Cascade, onUpdate: Restrict)
}

model Sessions {
  id            Int      @id @default(autoincrement())
  user_id       Int
  session_token String   @unique
  expires_at    DateTime
  ip_address    String
  ip_location   String

  users Users @relation(fields: [user_id], references: [id])
}

model Users {
  id       Int     @id @default(autoincrement())
  name     String?
  email    String  @unique
  password String

  tokens   Sessions[]
  accounts Accounts[]
}
